{% from 'button/button.html' import govieButton %}

{% macro goviePagination(props) %}
  {%- set display_pages = [] -%}
      
  {% if props.currentPage > 3 %}
    {% set display_pages = (display_pages.push(1), display_pages) %}
  {% endif %}

  {% if props.currentPage > 4 %}
    {% set display_pages = (display_pages.push(-1), display_pages) %}
  {% endif %}

  {% for index in range(props.currentPage - 2, props.currentPage + 3) %}
    {% if index >= 1 and index <= props.totalPages %}
      {% set display_pages = (display_pages.push(index), display_pages) %}
    {% endif %}
  {% endfor %}

  {% if props.currentPage < props.totalPages - 3 %}
    {% set display_pages = (display_pages.push(-2), display_pages) %}
  {% endif %}

  {% if props.currentPage < props.totalPages - 2 %}
    {% set display_pages = (display_pages.push(props.totalPages), display_pages) %}
  {% endif %}

  <div
    class="gi-pagination"
    data-current-page="{{ props.currentPage }}"
    data-total-pages="{{ props.totalPages }}"
    data-testid="govie-pagination"
    data-module="gieds-pagination"
  >
    {# Previous Button #}
    {{ 
      govieButton({
        "content": "<span data-testid=\"govie-icon\" role=\"presentation\" class=\"material-symbols-outlined gi-block gi-text-[24px]\">arrow_left_alt</span> <span class='xs:gi-block gi-hidden'>Previous</span>",
        "variant": "flat",
        "size": "large",
        "appearance": "dark",
        "disabled": props.currentPage == 1,
        "href": "#", 
        "target": "_self",
        "testId": "govie-pagination-prev-btn",
        "data-current-page": props.currentPage - 1
      }) 
    }}

    {# Pagination - Compact View (visible on small screens only) #}
    <div class="gi-text-md xs:gi-hidden gi-block">
      <span class="gi-font-bold">Page {{ props.currentPage }}</span> of {{ props.totalPages }}
    </div>

    {# Pagination - Buttons (visible on larger screens) #}
    <div class="xs:gi-flex gi-items-center gi-justify-between gi-gap-2 gi-hidden">
      {% for page in display_pages %}
        {% if page == -1 or page == -2 %}
          <span class="material-symbols-outlined gi-gray-700">more_horiz</span>
        {% else %}
          {{ 
            govieButton({
              "content": page|string,
              "variant": "flat" if page != props.currentPage else "flat-dark",
              "size": "large",
              "appearance": "dark",
              "href": "#", 
              "target": "_self",
              "data-page": page
            }) 
          }}
        {% endif %}
      {% endfor %}
    </div>

    {# Next Button #}
    {{ 
      govieButton({
        "content": "<span class='xs:gi-block gi-hidden'>Next</span> <span data-testid=\"govie-icon\" role=\"presentation\" class=\"material-symbols-outlined gi-block gi-text-[24px]\">arrow_right_alt</span>",
        "variant": "flat",
        "size": "large",
        "appearance": "dark",
        "href": "#",
        "target": "_self",
        "disabled": props.currentPage == props.totalPages,
        "testId": "govie-pagination-next-btn",
        "data-current-page": props.currentPage + 1
      }) 
    }}
  </div>
{% endmacro %}
